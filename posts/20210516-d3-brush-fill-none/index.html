<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ä½¿ç”¨ d3-brush å¾Œæ–‡å­—ä¸è¦‹ï¼Ÿäº†è§£ svg çš„é¡è‰²è¨­å®š | TzuWei's Blog ğŸ </title><meta name=keywords content="d3.js,svg"><meta name=description content="å‰é™£å­ï¼Œåœ¨ä¿®è³‡æ–™è¦–è¦ºåŒ–çš„åŒå­¸å¯«ä½œæ¥­é‡åˆ°äº†ä¸€å€‹å•é¡Œï¼Œå¹«ä»–è§£æ±ºå¾Œç™¼ç¾è£¡é¢æœ‰ä¸å°‘æ±è¥¿å¯ä»¥è¨˜éŒ„ä¸‹ä¾†ã€‚
é€™ä¸€ç¯‡æœƒåˆ†æˆä¸‰å€‹éƒ¨åˆ†
 è§£æ±ºåŒå­¸é‡åˆ°çš„ bugï¼šä½¿ç”¨ d3-brush å¾Œæ–‡å­—æ¶ˆå¤± äº†è§£ d3-brush çš„è¡Œç‚º d3-axis é¡è‰²çš„æœ‰è¶£ç™¼ç¾  ä½¿ç”¨ d3-brush å¾Œæ–‡å­—æ¶ˆå¤± æˆ‘å€‘è¦çœ‹çš„æ˜¯ä¸‹é¢é€™æ®µç¨‹å¼ï¼Œä¹Ÿå¯ä»¥åˆ°æˆ‘çš„ observable çœ‹ render çš„çµæœã€‚
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  <!DOCTYPE html> <html lang=&#34;en&#34;> <head> <meta charset=&#34;UTF-8&#34;> <title>Demo</title> <script src=&#34;https://cdnjs.cloudflare.com/ajax/libs/d3/5.0.0/d3.min.js&#34;></script> <script src=&#34;https://cdnjs.cloudflare.com/ajax/libs/d3-brush/1.0.4/d3-brush.min.js&#34;></script> </head> <body> <svg width=&#34;100&#34; height=&#34;100&#34;></svg> <script> const brush = d3."><meta name=author content><link rel=canonical href=https://uier.github.io/blog/posts/20210516-d3-brush-fill-none/><link href=/blog/assets/css/stylesheet.min.c076f7e57fc898d79896f01b86b45a2283c95da97e7afd41700b61e878931da3.css integrity="sha256-wHb35X/ImNeYlvAbhrRaIoPJXal+ev1BcAth6HiTHaM=" rel="preload stylesheet" as=style><link rel=icon href=https://uier.github.io/blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://uier.github.io/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://uier.github.io/blog/favicon-32x32.png><link rel=apple-touch-icon href=https://uier.github.io/blog/apple-touch-icon.png><link rel=mask-icon href=https://uier.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.81.0"><script async src="https://www.googletagmanager.com/gtag/js?id=G-EWHVMQWQYV"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-EWHVMQWQYV')</script><meta property="og:title" content="ä½¿ç”¨ d3-brush å¾Œæ–‡å­—ä¸è¦‹ï¼Ÿäº†è§£ svg çš„é¡è‰²è¨­å®š"><meta property="og:description" content="å‰é™£å­ï¼Œåœ¨ä¿®è³‡æ–™è¦–è¦ºåŒ–çš„åŒå­¸å¯«ä½œæ¥­é‡åˆ°äº†ä¸€å€‹å•é¡Œï¼Œå¹«ä»–è§£æ±ºå¾Œç™¼ç¾è£¡é¢æœ‰ä¸å°‘æ±è¥¿å¯ä»¥è¨˜éŒ„ä¸‹ä¾†ã€‚
é€™ä¸€ç¯‡æœƒåˆ†æˆä¸‰å€‹éƒ¨åˆ†
 è§£æ±ºåŒå­¸é‡åˆ°çš„ bugï¼šä½¿ç”¨ d3-brush å¾Œæ–‡å­—æ¶ˆå¤± äº†è§£ d3-brush çš„è¡Œç‚º d3-axis é¡è‰²çš„æœ‰è¶£ç™¼ç¾  ä½¿ç”¨ d3-brush å¾Œæ–‡å­—æ¶ˆå¤± æˆ‘å€‘è¦çœ‹çš„æ˜¯ä¸‹é¢é€™æ®µç¨‹å¼ï¼Œä¹Ÿå¯ä»¥åˆ°æˆ‘çš„ observable çœ‹ render çš„çµæœã€‚
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  <!DOCTYPE html> <html lang=&#34;en&#34;> <head> <meta charset=&#34;UTF-8&#34;> <title>Demo</title> <script src=&#34;https://cdnjs.cloudflare.com/ajax/libs/d3/5.0.0/d3.min.js&#34;></script> <script src=&#34;https://cdnjs.cloudflare.com/ajax/libs/d3-brush/1.0.4/d3-brush.min.js&#34;></script> </head> <body> <svg width=&#34;100&#34; height=&#34;100&#34;></svg> <script> const brush = d3."><meta property="og:type" content="article"><meta property="og:url" content="https://uier.github.io/blog/posts/20210516-d3-brush-fill-none/"><meta property="article:published_time" content="2021-05-16T20:53:54+08:00"><meta property="article:modified_time" content="2021-05-16T20:53:54+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="ä½¿ç”¨ d3-brush å¾Œæ–‡å­—ä¸è¦‹ï¼Ÿäº†è§£ svg çš„é¡è‰²è¨­å®š"><meta name=twitter:description content="å‰é™£å­ï¼Œåœ¨ä¿®è³‡æ–™è¦–è¦ºåŒ–çš„åŒå­¸å¯«ä½œæ¥­é‡åˆ°äº†ä¸€å€‹å•é¡Œï¼Œå¹«ä»–è§£æ±ºå¾Œç™¼ç¾è£¡é¢æœ‰ä¸å°‘æ±è¥¿å¯ä»¥è¨˜éŒ„ä¸‹ä¾†ã€‚
é€™ä¸€ç¯‡æœƒåˆ†æˆä¸‰å€‹éƒ¨åˆ†
 è§£æ±ºåŒå­¸é‡åˆ°çš„ bugï¼šä½¿ç”¨ d3-brush å¾Œæ–‡å­—æ¶ˆå¤± äº†è§£ d3-brush çš„è¡Œç‚º d3-axis é¡è‰²çš„æœ‰è¶£ç™¼ç¾  ä½¿ç”¨ d3-brush å¾Œæ–‡å­—æ¶ˆå¤± æˆ‘å€‘è¦çœ‹çš„æ˜¯ä¸‹é¢é€™æ®µç¨‹å¼ï¼Œä¹Ÿå¯ä»¥åˆ°æˆ‘çš„ observable çœ‹ render çš„çµæœã€‚
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27  <!DOCTYPE html> <html lang=&#34;en&#34;> <head> <meta charset=&#34;UTF-8&#34;> <title>Demo</title> <script src=&#34;https://cdnjs.cloudflare.com/ajax/libs/d3/5.0.0/d3.min.js&#34;></script> <script src=&#34;https://cdnjs.cloudflare.com/ajax/libs/d3-brush/1.0.4/d3-brush.min.js&#34;></script> </head> <body> <svg width=&#34;100&#34; height=&#34;100&#34;></svg> <script> const brush = d3."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"ä½¿ç”¨ d3-brush å¾Œæ–‡å­—ä¸è¦‹ï¼Ÿäº†è§£ svg çš„é¡è‰²è¨­å®š","name":"ä½¿ç”¨ d3-brush å¾Œæ–‡å­—ä¸è¦‹ï¼Ÿäº†è§£ svg çš„é¡è‰²è¨­å®š","description":"å‰é™£å­ï¼Œåœ¨ä¿®è³‡æ–™è¦–è¦ºåŒ–çš„åŒå­¸å¯«ä½œæ¥­é‡åˆ°äº†ä¸€å€‹å•é¡Œï¼Œå¹«ä»–è§£æ±ºå¾Œç™¼ç¾è£¡é¢æœ‰ä¸å°‘æ±è¥¿å¯ä»¥è¨˜éŒ„ä¸‹ä¾†ã€‚\né€™ä¸€ç¯‡æœƒåˆ†æˆä¸‰å€‹éƒ¨åˆ†\n è§£æ±ºåŒå­¸é‡åˆ°çš„ bugï¼šä½¿ç”¨ d3-brush å¾Œæ–‡å­—æ¶ˆå¤± äº†è§£ d3-brush çš„è¡Œç‚º d3-axis é¡è‰²çš„æœ‰è¶£ç™¼ç¾  ä½¿ç”¨ d3-brush å¾Œæ–‡å­—æ¶ˆå¤± æˆ‘å€‘è¦çœ‹çš„æ˜¯ä¸‹é¢é€™æ®µç¨‹å¼ï¼Œä¹Ÿå¯ä»¥åˆ°æˆ‘çš„ observable çœ‹ render  â€¦","keywords":["d3.js","svg"],"articleBody":"å‰é™£å­ï¼Œåœ¨ä¿®è³‡æ–™è¦–è¦ºåŒ–çš„åŒå­¸å¯«ä½œæ¥­é‡åˆ°äº†ä¸€å€‹å•é¡Œï¼Œå¹«ä»–è§£æ±ºå¾Œç™¼ç¾è£¡é¢æœ‰ä¸å°‘æ±è¥¿å¯ä»¥è¨˜éŒ„ä¸‹ä¾†ã€‚\né€™ä¸€ç¯‡æœƒåˆ†æˆä¸‰å€‹éƒ¨åˆ†\n è§£æ±ºåŒå­¸é‡åˆ°çš„ bugï¼šä½¿ç”¨ d3-brush å¾Œæ–‡å­—æ¶ˆå¤± äº†è§£ d3-brush çš„è¡Œç‚º d3-axis é¡è‰²çš„æœ‰è¶£ç™¼ç¾  ä½¿ç”¨ d3-brush å¾Œæ–‡å­—æ¶ˆå¤± æˆ‘å€‘è¦çœ‹çš„æ˜¯ä¸‹é¢é€™æ®µç¨‹å¼ï¼Œä¹Ÿå¯ä»¥åˆ°æˆ‘çš„ observable çœ‹ render çš„çµæœã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27   html lang=\"en\" head meta charset=\"UTF-8\" titleDemotitle script src=\"https://cdnjs.cloudflare.com/ajax/libs/d3/5.0.0/d3.min.js\"script script src=\"https://cdnjs.cloudflare.com/ajax/libs/d3-brush/1.0.4/d3-brush.min.js\"script head body svg width=\"100\" height=\"100\"svg script const brush = d3.brush().extent([[0, 0], [100, 100]]); const svg = d3.select(\"svg\"); const g = svg.append(\"g\"); g.append(\"text\") .attr(\"transform\", \"translate(0, 50)\") .attr(\"font-size\", \"15px\") .text(\"Hello, world\"); // try to comment the code below, and the text will reveal  g.call(brush); script body html   å•é¡Œæ˜¯é€™æ¨£å­ï¼Œåœ¨å…§æœ‰ä¸€å€‹ç¾¤çµ„å…ƒç´ ï¼Œè£¡é¢åˆæœ‰ä¸€å€‹é¡¯ç¤ºHello, worldçš„æ–‡å­—å…ƒç´ ï¼Œç•¶å¥—ç”¨ d3-brush å¾Œæ–‡å­—å°±æ¶ˆå¤±ä¸è¦‹äº†ï¼Œè‹¥æŠŠg.call(brush)è¨»è§£æ‰å‰‡æ–‡å­—å°±å¯ä»¥å‡ºç¾ã€‚\næ‰“é–‹ç€è¦½å™¨çš„é–‹ç™¼è€…å·¥å…·ï¼Œåœ¨ DOM è£¡é¢é‚„æ˜¯å¯ä»¥æ‰¾åˆ°ï¼Œä½†æˆ‘å€‘å»çœ‹ä¸åˆ°ä»–ã€‚\n\u0008ä¸éçœ¼å°–å°±æœƒç™¼ç¾ä¸Šä¸€å±¤çš„æœ‰ attributefill=\"none\"ï¼Œå› ç‚ºæˆ‘å€‘æ²’æœ‰ç‚ºæŒ‡å®š fill çš„é¡è‰²ï¼Œè€Œé€™å€‹å…ƒç´ æœƒè®“ä»–çš„ children ç¹¼æ‰¿ä»–çš„ attributeï¼Œæ‰€ä»¥é€ æˆç¹¼æ‰¿äº†fill=\"none\"ã€‚é—œæ–¼å…ƒç´ çš„èªªæ˜å¯ä»¥çœ‹ MDN çš„æ–‡ä»¶ ã€‚\nçµè«–æ˜¯ï¼Œè¨˜å¾—ä¹Ÿè¦åœ¨ä¸Šè¨­å®š fill å±¬æ€§ï¼Œå°±èƒ½é †åˆ©é¡¯ç¤ºæ–‡å­—ï¼š\n1 2 3 4 5  g.append(\"text\") .attr(\"transform\", \"translate(0, 50)\") .attr(\"font-size\", \"15px\") .attr(\"fill\", \"black\") .text(\"Hello, world\");   d3-brush çš„è¡Œç‚º é‚£éº¼ç‚ºä½•ä¸Šå±¤çš„æœƒæ˜¯fill=\"none\"å‘¢ï¼Ÿ\nç•¶æ²’æœ‰å¥—ç”¨ d3-brush æ™‚ï¼Œæœƒçœ‹åˆ°çš„ fill æ˜¯æ¡ç”¨é è¨­å€¼é»‘è‰²ï¼Œä¸¦æ²’æœ‰è¢«è¨­å®šæˆfill=\"none\"ï¼Œå‰‡æ˜¯å› ç‚ºç¹¼æ‰¿è€Œä¹Ÿé¡¯ç¤ºé»‘è‰²ã€‚\næ‰€ä»¥æˆ‘å€‘å¯ä»¥æ‡·ç–‘ d3-brush æŠŠæˆ‘å€‘çš„åŠ ä¸Šäº†fill=\"none\"ã€‚\né—œæ–¼ d3-brush çš„è¡Œç‚ºï¼Œ æ–‡ä»¶ è£¡é ­æœ‰è©³ç´°çš„èªªæ˜ï¼Œä¸»è¦æ˜¯ä¸‹åˆ—é€™æ®µï¼š\n The brush also creates the SVG elements necessary to display the brush selection and to receive input events for interaction. You can add, remove or modify these elements as desired to change the brush appearance; you can also apply stylesheets to modify the brush appearance. The structure of a two-dimensional brush is as follows:\n 1 2 3 4 5 6 7 8 9 10 11 12  g class=\"brush\" fill=\"none\" pointer-events=\"all\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\" rect class=\"overlay\" pointer-events=\"all\" cursor=\"crosshair\" x=\"0\" y=\"0\" width=\"960\" height=\"500\"rect rect class=\"selection\" cursor=\"move\" fill=\"#777\" fill-opacity=\"0.3\" stroke=\"#fff\" shape-rendering=\"crispEdges\" x=\"112\" y=\"194\" width=\"182\" height=\"83\"rect rect class=\"handle handle--n\" cursor=\"ns-resize\" x=\"107\" y=\"189\" width=\"192\" height=\"10\"rect rect class=\"handle handle--e\" cursor=\"ew-resize\" x=\"289\" y=\"189\" width=\"10\" height=\"93\"rect rect class=\"handle handle--s\" cursor=\"ns-resize\" x=\"107\" y=\"272\" width=\"192\" height=\"10\"rect rect class=\"handle handle--w\" cursor=\"ew-resize\" x=\"107\" y=\"189\" width=\"10\" height=\"93\"rect rect class=\"handle handle--nw\" cursor=\"nwse-resize\" x=\"107\" y=\"189\" width=\"10\" height=\"10\"rect rect class=\"handle handle--ne\" cursor=\"nesw-resize\" x=\"289\" y=\"189\" width=\"10\" height=\"10\"rect rect class=\"handle handle--se\" cursor=\"nwse-resize\" x=\"289\" y=\"272\" width=\"10\" height=\"10\"rect rect class=\"handle handle--sw\" cursor=\"nesw-resize\" x=\"107\" y=\"272\" width=\"10\" height=\"10\"rect g   å¥—ç”¨å¾Œæœƒæ”¹è®Šçš„å±¬æ€§ï¼Œå¦å¤–ç¸½å…±æœƒç”¢ç”Ÿ 10 å€‹ï¼š\n æœƒè¦†è“‹æ•´å€‹ã€‚ æ˜¯é¡¯ç¤º brush å¾Œæ¡†é¸åˆ°çš„ç¯„åœï¼Œå¯ä»¥çœ‹åˆ°ä»–æœ‰è¨­å®š fill ç‚ºç°è‰²ã€‚ å¾Œé¢å…«å€‹å‰‡æ˜¯ç”¨ä¾†èª¿æ•´æ¡†é¸ç¯„åœå¤§å°çš„æ§åˆ¶å™¨ï¼ŒåŒ…å«äº†å››å€‹é‚Šè·Ÿå››å€‹è§’è½ã€‚  ä¹Ÿå› æ­¤ d3-brush è¨­å®šäº†fill=\"none\"ä¾†éš±è—é€™äº›ï¼Œä½ ä¹Ÿå¯ä»¥æ‰“é–‹é–‹ç™¼è€…å·¥å…·æ‰‹å‹•æŠŠ fill æ”¹æˆå…¶ä»–é¡è‰²çœ‹çœ‹æœƒå¦‚ä½•ã€‚åœ¨ä¸‹é¢é€™å¼µåœ–ï¼Œæˆ‘æŠŠæ›´æ”¹æˆfill=\"red\"ã€‚\nå…¶å¯¦åœ¨å¹«åŒå­¸çœ‹é€™å€‹å•é¡Œæ™‚æœ‰çœ‹åˆ°ä»–å˜—è©¦å¯«äº†ï¼Œç„¶è€Œ color åœ¨ SVG ä¸­ä¸¦ä¸æ˜¯ä»–æ‰€æƒ³çš„é‚£æ¨£ï¼Œä¸‹ä¸€å€‹éƒ¨åˆ†æœƒå†æåˆ° color é€™å€‹å±¬æ€§ã€‚\nå›é ­å»æƒ³ï¼Œä»–ä¹‹æ‰€ä»¥æœƒéœ€è¦åœ¨è£¡é¢åŠ ï¼Œæ˜¯å› ç‚ºæƒ³åœ¨ x è»¸ä»¥åŠ y è»¸æ—åŠ ä¸Šæ–‡å­—æ¨™ç±¤ï¼Œé€™è®“æˆ‘æƒ³åˆ°æˆ‘å€‘åœ¨ d3 å»ºç«‹ x è»¸è·Ÿ y è»¸æ™‚ï¼Œä¹Ÿéƒ½æ˜¯åŒ…å«åœ¨å…ƒç´ è£¡çš„ï¼Œè»¸ç·šç”¨çš„æ˜¯ã€tick è·Ÿ label ç”¨çš„æ˜¯è·Ÿï¼Œæ–¼æ˜¯æˆ‘å¥½å¥‡ d3-axis æ˜¯å¦‚ä½•è¨­å®šä»–å€‘çš„ fill å±¬æ€§ã€‚\nd3-axis çš„é¡è‰²è¨­å®š åœ¨ç¿» source code æ™‚è®“æˆ‘ç™¼ç¾ä¸€ä»¶æœ‰è¶£çš„äº‹æƒ…ï¼Œåœ¨ d3 v4ï¼ˆd3-axis fill=\"#000\"ï¼Œå¯ä»¥çœ‹ é€™æ®µ code ï¼Œæˆ‘åŒæ™‚ä¹Ÿé™„åœ¨ä¸‹åœ–ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12  path = path.merge(path.enter().insert(\"path\", \".tick\") .attr(\"class\", \"domain\") .attr(\"stroke\", \"#000\")); line = line.merge(tickEnter.append(\"line\") .attr(\"stroke\", \"#000\") .attr(x + \"2\", k * tickSizeInner)); text = text.merge(tickEnter.append(\"text\") .attr(\"fill\", \"#000\") .attr(x, k * spacing) .attr(\"dy\", orient === top ? \"0em\" : orient === bottom ? \"0.71em\" : \"0.32em\"));   è€Œå¾Œä¾†ï¼Œä½œè€…è‡ªå·±é–‹äº†é€™å€‹ issue ä¸¦æ›´æ”¹æˆfill=\"currentcolor\"ï¼Œå¦‚ä¸‹åœ–ã€‚\ncurrentcolor æ˜¯ä»€éº¼ï¼Ÿ fill, stroke é€™äº›è¨­å®šé¡è‰²çš„å±¬æ€§ï¼Œé™¤äº†å¯ä»¥è¨­ç‚ºä¸€å€‹é¡è‰²çš„ rgb å€¼ã€hex å€¼ç­‰ï¼Œä¹Ÿå¯ä»¥è¨­å®šç‚º currentcolorï¼Œå¦‚fill=\"currentcolor\"ã€‚\nè€Œç©¶ç«Ÿä»–æœƒè¨­å®šæˆä»€éº¼é¡è‰²å‘¢ï¼Œç­”æ¡ˆæ˜¯ color é€™å€‹å±¬æ€§çš„é¡è‰²ï¼Œè‹¥æ²’æœ‰è¨­å®š color å‰‡æœƒç¹¼æ‰¿ parent çš„ colorã€‚\ncurrentcolor è®“æˆ‘å€‘åœ¨è¨­å®šé¡è‰²æ™‚ï¼Œå¯ä»¥é€éä¸Šå±¤çš„ color ä¾†çµ±ä¸€ç’°å¢ƒçš„é¡è‰²ï¼Œä¸å¿…å–®ç¨ç®¡ç†æ¯å€‹å­å…ƒç´ çš„é¡è‰²ã€‚\nä»¥ä¸Šè¿°æåˆ° d3-axis çš„ issue ä¾†èˆ‰ä¾‹ï¼Œä½œè€…çš„è€ƒé‡æ˜¯å¸Œæœ› axis çš„é¡è‰²å¯ä»¥å½ˆæ€§çš„æ›´æ”¹ã€‚è‹¥å¯«æ­»æˆé»‘è‰²ï¼Œç•¶èƒŒæ™¯è‰²æ˜¯æ·±è‰²çš„æƒ…æ³ä¸‹ï¼Œå°±éœ€è¦é é–‹ç™¼è€…è‡ªå·±å»é‡æ–°è¨­å®šé¡è‰²ã€‚\næˆ‘æ ¹æ“šé€™å€‹æƒ…å¢ƒå¯«äº†ä¸€å€‹ ç¯„ä¾‹ ï¼Œè®“å¤§å®¶å¯ä»¥å°æ¯”é€™å€‹æ”¹è®Šçš„å¨åŠ›ã€‚\n","wordCount":"464","inLanguage":"en","datePublished":"2021-05-16T20:53:54+08:00","dateModified":"2021-05-16T20:53:54+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://uier.github.io/blog/posts/20210516-d3-brush-fill-none/"},"publisher":{"@type":"Organization","name":"TzuWei's Blog ğŸ ","logo":{"@type":"ImageObject","url":"https://uier.github.io/blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>.theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://uier.github.io/blog/ accesskey=h title="TzuWei's Blog ğŸ  (Alt + H)">TzuWei's Blog ğŸ </a>
<span class=logo-switches><span class=theme-toggle title="(Alt + T)"><a id=theme-toggle accesskey=t><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></a></span></span></div><ul class=menu id=menu onscroll=menu_on_scroll()><li><a href=https://uier.github.io/blog/ title=Home><span>Home</span></a></li><li><a href=https://uier.github.io/blog/about/ title=About><span>About</span></a></li><li><a href=https://uier.github.io/blog/archive/ title=Archive><span>Archive</span></a></li><li><a href=https://uier.github.io/blog/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://uier.github.io/blog/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://uier.github.io/blog/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>ä½¿ç”¨ d3-brush å¾Œæ–‡å­—ä¸è¦‹ï¼Ÿäº†è§£ svg çš„é¡è‰²è¨­å®š</h1><div class=post-description></div><div class=post-meta>May 16, 2021</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><blockquote><ul><li><a href=#%e4%bd%bf%e7%94%a8-d3-brush-%e5%be%8c%e6%96%87%e5%ad%97%e6%b6%88%e5%a4%b1 aria-label="ä½¿ç”¨ d3-brush å¾Œæ–‡å­—æ¶ˆå¤±">ä½¿ç”¨ d3-brush å¾Œæ–‡å­—æ¶ˆå¤±</a></li><li><a href=#d3-brush-%e7%9a%84%e8%a1%8c%e7%82%ba aria-label="d3-brush çš„è¡Œç‚º">d3-brush çš„è¡Œç‚º</a></li><li><a href=#d3-axis-%e7%9a%84%e9%a1%8f%e8%89%b2%e8%a8%ad%e5%ae%9a aria-label="d3-axis çš„é¡è‰²è¨­å®š">d3-axis çš„é¡è‰²è¨­å®š</a><ul><li><a href=#currentcolor-%e6%98%af%e4%bb%80%e9%ba%bc aria-label="currentcolor æ˜¯ä»€éº¼ï¼Ÿ">currentcolor æ˜¯ä»€éº¼ï¼Ÿ</a></li></ul></li></ul></blockquote></details></div><div class=post-content><p>å‰é™£å­ï¼Œåœ¨ä¿®è³‡æ–™è¦–è¦ºåŒ–çš„åŒå­¸å¯«ä½œæ¥­é‡åˆ°äº†ä¸€å€‹å•é¡Œï¼Œå¹«ä»–è§£æ±ºå¾Œç™¼ç¾è£¡é¢æœ‰ä¸å°‘æ±è¥¿å¯ä»¥è¨˜éŒ„ä¸‹ä¾†ã€‚</p><p>é€™ä¸€ç¯‡æœƒåˆ†æˆä¸‰å€‹éƒ¨åˆ†</p><ul><li>è§£æ±ºåŒå­¸é‡åˆ°çš„ bugï¼š<a href=#%E4%BD%BF%E7%94%A8-d3-brush-%E5%BE%8C%E6%96%87%E5%AD%97%E6%B6%88%E5%A4%B1>ä½¿ç”¨ d3-brush å¾Œæ–‡å­—æ¶ˆå¤±</a></li><li><a href=#d3-brush-%E7%9A%84%E8%A1%8C%E7%82%BA>äº†è§£ d3-brush çš„è¡Œç‚º</a></li><li><a href=#d3-axis-%E7%9A%84%E9%A1%8F%E8%89%B2%E8%A8%AD%E5%AE%9A>d3-axis é¡è‰²çš„æœ‰è¶£ç™¼ç¾</a></li></ul><h2 id=ä½¿ç”¨-d3-brush-å¾Œæ–‡å­—æ¶ˆå¤±>ä½¿ç”¨ d3-brush å¾Œæ–‡å­—æ¶ˆå¤±<a hidden class=anchor aria-hidden=true href=#ä½¿ç”¨-d3-brush-å¾Œæ–‡å­—æ¶ˆå¤±>#</a></h2><p>æˆ‘å€‘è¦çœ‹çš„æ˜¯ä¸‹é¢é€™æ®µç¨‹å¼ï¼Œä¹Ÿå¯ä»¥åˆ°æˆ‘çš„
<a href="https://observablehq.com/@uier/d3-brush-fill-none?ui=classic" rel=noopener target=_blank>observable</a>
çœ‹ render çš„çµæœã€‚</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=color:#ff79c6>&lt;!DOCTYPE html&gt;</span>
&lt;<span style=color:#ff79c6>html</span> <span style=color:#50fa7b>lang</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;en&#34;</span>&gt;
&lt;<span style=color:#ff79c6>head</span>&gt;
  &lt;<span style=color:#ff79c6>meta</span> <span style=color:#50fa7b>charset</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;UTF-8&#34;</span>&gt;
  &lt;<span style=color:#ff79c6>title</span>&gt;Demo&lt;/<span style=color:#ff79c6>title</span>&gt;
  &lt;<span style=color:#ff79c6>script</span> <span style=color:#50fa7b>src</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;https://cdnjs.cloudflare.com/ajax/libs/d3/5.0.0/d3.min.js&#34;</span>&gt;&lt;/<span style=color:#ff79c6>script</span>&gt;
  &lt;<span style=color:#ff79c6>script</span> <span style=color:#50fa7b>src</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;https://cdnjs.cloudflare.com/ajax/libs/d3-brush/1.0.4/d3-brush.min.js&#34;</span>&gt;&lt;/<span style=color:#ff79c6>script</span>&gt;
&lt;/<span style=color:#ff79c6>head</span>&gt;
&lt;<span style=color:#ff79c6>body</span>&gt;
  &lt;<span style=color:#ff79c6>svg</span> <span style=color:#50fa7b>width</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;100&#34;</span> <span style=color:#50fa7b>height</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;100&#34;</span>&gt;&lt;/<span style=color:#ff79c6>svg</span>&gt;

  &lt;<span style=color:#ff79c6>script</span>&gt;
    <span style=color:#ff79c6>const</span> brush <span style=color:#ff79c6>=</span> d3.brush().extent([[<span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>0</span>], [<span style=color:#bd93f9>100</span>, <span style=color:#bd93f9>100</span>]]);

    <span style=color:#ff79c6>const</span> svg <span style=color:#ff79c6>=</span> d3.select(<span style=color:#f1fa8c>&#34;svg&#34;</span>);
    <span style=color:#ff79c6>const</span> g <span style=color:#ff79c6>=</span> svg.append(<span style=color:#f1fa8c>&#34;g&#34;</span>);

    g.append(<span style=color:#f1fa8c>&#34;text&#34;</span>)
      .attr(<span style=color:#f1fa8c>&#34;transform&#34;</span>, <span style=color:#f1fa8c>&#34;translate(0, 50)&#34;</span>)
      .attr(<span style=color:#f1fa8c>&#34;font-size&#34;</span>, <span style=color:#f1fa8c>&#34;15px&#34;</span>)
      .text(<span style=color:#f1fa8c>&#34;Hello, world&#34;</span>);

    <span style=color:#6272a4>// try to comment the code below, and the text will reveal
</span><span style=color:#6272a4></span>    g.call(brush);
  &lt;/<span style=color:#ff79c6>script</span>&gt;
&lt;/<span style=color:#ff79c6>body</span>&gt;
&lt;/<span style=color:#ff79c6>html</span>&gt;
</code></pre></td></tr></table></div></div><p>å•é¡Œæ˜¯é€™æ¨£å­ï¼Œåœ¨<code>&lt;svg></code>å…§æœ‰ä¸€å€‹ç¾¤çµ„å…ƒç´ <code>&lt;g></code>ï¼Œè£¡é¢åˆæœ‰ä¸€å€‹é¡¯ç¤º<code>Hello, world</code>çš„æ–‡å­—å…ƒç´ <code>&lt;text></code>ï¼Œç•¶å¥—ç”¨ d3-brush å¾Œæ–‡å­—å°±æ¶ˆå¤±ä¸è¦‹äº†ï¼Œè‹¥æŠŠ<code>g.call(brush)</code>è¨»è§£æ‰å‰‡æ–‡å­—å°±å¯ä»¥å‡ºç¾ã€‚</p><p>æ‰“é–‹ç€è¦½å™¨çš„é–‹ç™¼è€…å·¥å…·ï¼Œåœ¨ DOM è£¡é¢é‚„æ˜¯å¯ä»¥æ‰¾åˆ°<code>&lt;text></code>ï¼Œä½†æˆ‘å€‘å»çœ‹ä¸åˆ°ä»–ã€‚</p><p><img src=/20210516/d3-brush-demo.png alt=inspect-element></p><p>ä¸éçœ¼å°–å°±æœƒç™¼ç¾ä¸Šä¸€å±¤çš„<code>&lt;g></code>æœ‰ attribute<code>fill="none"</code>ï¼Œå› ç‚ºæˆ‘å€‘æ²’æœ‰ç‚º<code>&lt;text></code>æŒ‡å®š fill çš„é¡è‰²ï¼Œè€Œ<code>&lt;g></code>é€™å€‹å…ƒç´ æœƒè®“ä»–çš„ children ç¹¼æ‰¿ä»–çš„ attributeï¼Œæ‰€ä»¥é€ æˆ<code>&lt;text></code>ç¹¼æ‰¿äº†<code>fill="none"</code>ã€‚é—œæ–¼<code>&lt;g></code>å…ƒç´ çš„èªªæ˜å¯ä»¥çœ‹
<a href=https://developer.mozilla.org/en-US/docs/Web/SVG/Element/g rel=noopener target=_blank>MDN çš„æ–‡ä»¶</a>
ã€‚</p><p>çµè«–æ˜¯ï¼Œè¨˜å¾—ä¹Ÿè¦åœ¨<code>&lt;text></code>ä¸Šè¨­å®š fill å±¬æ€§ï¼Œå°±èƒ½é †åˆ©é¡¯ç¤ºæ–‡å­—ï¼š</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>g.append(<span style=color:#f1fa8c>&#34;text&#34;</span>)
  .attr(<span style=color:#f1fa8c>&#34;transform&#34;</span>, <span style=color:#f1fa8c>&#34;translate(0, 50)&#34;</span>)
  .attr(<span style=color:#f1fa8c>&#34;font-size&#34;</span>, <span style=color:#f1fa8c>&#34;15px&#34;</span>)
  .attr(<span style=color:#f1fa8c>&#34;fill&#34;</span>, <span style=color:#f1fa8c>&#34;black&#34;</span>)
  .text(<span style=color:#f1fa8c>&#34;Hello, world&#34;</span>);
</code></pre></td></tr></table></div></div><h2 id=d3-brush-çš„è¡Œç‚º>d3-brush çš„è¡Œç‚º<a hidden class=anchor aria-hidden=true href=#d3-brush-çš„è¡Œç‚º>#</a></h2><p>é‚£éº¼ç‚ºä½•ä¸Šå±¤çš„<code>&lt;g></code>æœƒæ˜¯<code>fill="none"</code>å‘¢ï¼Ÿ</p><p>ç•¶æ²’æœ‰å¥—ç”¨ d3-brush æ™‚ï¼Œæœƒçœ‹åˆ°<code>&lt;g></code>çš„ fill æ˜¯æ¡ç”¨é è¨­å€¼é»‘è‰²ï¼Œä¸¦æ²’æœ‰è¢«è¨­å®šæˆ<code>fill="none"</code>ï¼Œ<code>&lt;text></code>å‰‡æ˜¯å› ç‚ºç¹¼æ‰¿<code>&lt;g></code>è€Œä¹Ÿé¡¯ç¤ºé»‘è‰²ã€‚</p><p>æ‰€ä»¥æˆ‘å€‘å¯ä»¥æ‡·ç–‘ d3-brush æŠŠæˆ‘å€‘çš„<code>&lt;g></code>åŠ ä¸Šäº†<code>fill="none"</code>ã€‚</p><p>é—œæ–¼ d3-brush çš„è¡Œç‚ºï¼Œ
<a href=https://github.com/d3/d3-brush#api-reference rel=noopener target=_blank>æ–‡ä»¶</a>
è£¡é ­æœ‰è©³ç´°çš„èªªæ˜ï¼Œä¸»è¦æ˜¯ä¸‹åˆ—é€™æ®µï¼š</p><blockquote><p>The brush also creates the SVG elements necessary to display the brush selection and to receive input events for interaction. You can add, remove or modify these elements as desired to change the brush appearance; you can also apply stylesheets to modify the brush appearance. The structure of a two-dimensional brush is as follows:</p></blockquote><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#ff79c6>g</span> <span style=color:#50fa7b>class</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;brush&#34;</span> <span style=color:#50fa7b>fill</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;none&#34;</span> <span style=color:#50fa7b>pointer-events</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;all&#34;</span> <span style=color:#50fa7b>style</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);&#34;</span>&gt;
  &lt;<span style=color:#ff79c6>rect</span> <span style=color:#50fa7b>class</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;overlay&#34;</span> <span style=color:#50fa7b>pointer-events</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;all&#34;</span> <span style=color:#50fa7b>cursor</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;crosshair&#34;</span> <span style=color:#50fa7b>x</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;0&#34;</span> <span style=color:#50fa7b>y</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;0&#34;</span> <span style=color:#50fa7b>width</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;960&#34;</span> <span style=color:#50fa7b>height</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;500&#34;</span>&gt;&lt;/<span style=color:#ff79c6>rect</span>&gt;
  &lt;<span style=color:#ff79c6>rect</span> <span style=color:#50fa7b>class</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;selection&#34;</span> <span style=color:#50fa7b>cursor</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;move&#34;</span> <span style=color:#50fa7b>fill</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;#777&#34;</span> <span style=color:#50fa7b>fill-opacity</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;0.3&#34;</span> <span style=color:#50fa7b>stroke</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;#fff&#34;</span> <span style=color:#50fa7b>shape-rendering</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;crispEdges&#34;</span> <span style=color:#50fa7b>x</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;112&#34;</span> <span style=color:#50fa7b>y</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;194&#34;</span> <span style=color:#50fa7b>width</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;182&#34;</span> <span style=color:#50fa7b>height</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;83&#34;</span>&gt;&lt;/<span style=color:#ff79c6>rect</span>&gt;
  &lt;<span style=color:#ff79c6>rect</span> <span style=color:#50fa7b>class</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;handle handle--n&#34;</span> <span style=color:#50fa7b>cursor</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;ns-resize&#34;</span> <span style=color:#50fa7b>x</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;107&#34;</span> <span style=color:#50fa7b>y</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;189&#34;</span> <span style=color:#50fa7b>width</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;192&#34;</span> <span style=color:#50fa7b>height</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;10&#34;</span>&gt;&lt;/<span style=color:#ff79c6>rect</span>&gt;
  &lt;<span style=color:#ff79c6>rect</span> <span style=color:#50fa7b>class</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;handle handle--e&#34;</span> <span style=color:#50fa7b>cursor</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;ew-resize&#34;</span> <span style=color:#50fa7b>x</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;289&#34;</span> <span style=color:#50fa7b>y</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;189&#34;</span> <span style=color:#50fa7b>width</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;10&#34;</span> <span style=color:#50fa7b>height</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;93&#34;</span>&gt;&lt;/<span style=color:#ff79c6>rect</span>&gt;
  &lt;<span style=color:#ff79c6>rect</span> <span style=color:#50fa7b>class</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;handle handle--s&#34;</span> <span style=color:#50fa7b>cursor</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;ns-resize&#34;</span> <span style=color:#50fa7b>x</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;107&#34;</span> <span style=color:#50fa7b>y</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;272&#34;</span> <span style=color:#50fa7b>width</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;192&#34;</span> <span style=color:#50fa7b>height</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;10&#34;</span>&gt;&lt;/<span style=color:#ff79c6>rect</span>&gt;
  &lt;<span style=color:#ff79c6>rect</span> <span style=color:#50fa7b>class</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;handle handle--w&#34;</span> <span style=color:#50fa7b>cursor</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;ew-resize&#34;</span> <span style=color:#50fa7b>x</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;107&#34;</span> <span style=color:#50fa7b>y</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;189&#34;</span> <span style=color:#50fa7b>width</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;10&#34;</span> <span style=color:#50fa7b>height</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;93&#34;</span>&gt;&lt;/<span style=color:#ff79c6>rect</span>&gt;
  &lt;<span style=color:#ff79c6>rect</span> <span style=color:#50fa7b>class</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;handle handle--nw&#34;</span> <span style=color:#50fa7b>cursor</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;nwse-resize&#34;</span> <span style=color:#50fa7b>x</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;107&#34;</span> <span style=color:#50fa7b>y</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;189&#34;</span> <span style=color:#50fa7b>width</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;10&#34;</span> <span style=color:#50fa7b>height</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;10&#34;</span>&gt;&lt;/<span style=color:#ff79c6>rect</span>&gt;
  &lt;<span style=color:#ff79c6>rect</span> <span style=color:#50fa7b>class</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;handle handle--ne&#34;</span> <span style=color:#50fa7b>cursor</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;nesw-resize&#34;</span> <span style=color:#50fa7b>x</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;289&#34;</span> <span style=color:#50fa7b>y</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;189&#34;</span> <span style=color:#50fa7b>width</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;10&#34;</span> <span style=color:#50fa7b>height</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;10&#34;</span>&gt;&lt;/<span style=color:#ff79c6>rect</span>&gt;
  &lt;<span style=color:#ff79c6>rect</span> <span style=color:#50fa7b>class</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;handle handle--se&#34;</span> <span style=color:#50fa7b>cursor</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;nwse-resize&#34;</span> <span style=color:#50fa7b>x</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;289&#34;</span> <span style=color:#50fa7b>y</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;272&#34;</span> <span style=color:#50fa7b>width</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;10&#34;</span> <span style=color:#50fa7b>height</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;10&#34;</span>&gt;&lt;/<span style=color:#ff79c6>rect</span>&gt;
  &lt;<span style=color:#ff79c6>rect</span> <span style=color:#50fa7b>class</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;handle handle--sw&#34;</span> <span style=color:#50fa7b>cursor</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;nesw-resize&#34;</span> <span style=color:#50fa7b>x</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;107&#34;</span> <span style=color:#50fa7b>y</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;272&#34;</span> <span style=color:#50fa7b>width</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;10&#34;</span> <span style=color:#50fa7b>height</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;10&#34;</span>&gt;&lt;/<span style=color:#ff79c6>rect</span>&gt;
&lt;/<span style=color:#ff79c6>g</span>&gt;
</code></pre></td></tr></table></div></div><p>å¥—ç”¨å¾Œæœƒæ”¹è®Š<code>&lt;g></code>çš„å±¬æ€§ï¼Œå¦å¤–ç¸½å…±æœƒç”¢ç”Ÿ 10 å€‹<code>&lt;rect></code>ï¼š</p><ul><li><code>&lt;rect class="overlay" ... /></code>æœƒè¦†è“‹æ•´å€‹<code>&lt;g></code>ã€‚</li><li><code>&lt;rect class="selection" ... /></code>æ˜¯é¡¯ç¤º brush å¾Œæ¡†é¸åˆ°çš„ç¯„åœï¼Œå¯ä»¥çœ‹åˆ°ä»–æœ‰è¨­å®š fill ç‚ºç°è‰²ã€‚</li><li>å¾Œé¢å…«å€‹å‰‡æ˜¯ç”¨ä¾†èª¿æ•´æ¡†é¸ç¯„åœå¤§å°çš„æ§åˆ¶å™¨ï¼ŒåŒ…å«äº†å››å€‹é‚Šè·Ÿå››å€‹è§’è½ã€‚</li></ul><p>ä¹Ÿå› æ­¤ d3-brush è¨­å®šäº†<code>fill="none"</code>ä¾†éš±è—é€™äº›<code>&lt;rect></code>ï¼Œä½ ä¹Ÿå¯ä»¥æ‰“é–‹é–‹ç™¼è€…å·¥å…·æ‰‹å‹•æŠŠ fill æ”¹æˆå…¶ä»–é¡è‰²çœ‹çœ‹æœƒå¦‚ä½•ã€‚åœ¨ä¸‹é¢é€™å¼µåœ–ï¼Œæˆ‘æŠŠ<code>&lt;g></code>æ›´æ”¹æˆ<code>fill="red"</code>ã€‚</p><p><img src=/20210516/d3-brush-demo2.png alt=modify-element></p><p>å…¶å¯¦åœ¨å¹«åŒå­¸çœ‹é€™å€‹å•é¡Œæ™‚æœ‰çœ‹åˆ°ä»–å˜—è©¦å¯«äº†<code>&lt;text color="black"></code>ï¼Œç„¶è€Œ color åœ¨ SVG ä¸­ä¸¦ä¸æ˜¯ä»–æ‰€æƒ³çš„é‚£æ¨£ï¼Œä¸‹ä¸€å€‹éƒ¨åˆ†æœƒå†æåˆ° color é€™å€‹å±¬æ€§ã€‚</p><p>å›é ­å»æƒ³ï¼Œä»–ä¹‹æ‰€ä»¥æœƒéœ€è¦åœ¨<code>&lt;g></code>è£¡é¢åŠ <code>&lt;text></code>ï¼Œæ˜¯å› ç‚ºæƒ³åœ¨ x è»¸ä»¥åŠ y è»¸æ—åŠ ä¸Šæ–‡å­—æ¨™ç±¤ï¼Œé€™è®“æˆ‘æƒ³åˆ°æˆ‘å€‘åœ¨ d3 å»ºç«‹ x è»¸è·Ÿ y è»¸æ™‚ï¼Œä¹Ÿéƒ½æ˜¯åŒ…å«åœ¨<code>&lt;g></code>å…ƒç´ è£¡çš„ï¼Œè»¸ç·šç”¨çš„æ˜¯<code>&lt;path></code>ã€tick è·Ÿ label ç”¨çš„æ˜¯<code>&lt;line></code>è·Ÿ<code>&lt;text></code>ï¼Œæ–¼æ˜¯æˆ‘å¥½å¥‡ d3-axis æ˜¯å¦‚ä½•è¨­å®šä»–å€‘çš„ fill å±¬æ€§ã€‚</p><h2 id=d3-axis-çš„é¡è‰²è¨­å®š>d3-axis çš„é¡è‰²è¨­å®š<a hidden class=anchor aria-hidden=true href=#d3-axis-çš„é¡è‰²è¨­å®š>#</a></h2><p>åœ¨ç¿» source code æ™‚è®“æˆ‘ç™¼ç¾ä¸€ä»¶æœ‰è¶£çš„äº‹æƒ…ï¼Œåœ¨ d3 v4ï¼ˆd3-axis &lt;= v1.0.8ï¼‰æ™‚ï¼Œè»¸ç·šè·Ÿ tick label è¢«å¯«æ­»æˆ<code>fill="#000"</code>ï¼Œå¯ä»¥çœ‹
<a href=https://github.com/d3/d3-axis/blob/v1.0.8/src/axis.js#L63-L76 rel=noopener target=_blank>é€™æ®µ code</a>
ï¼Œæˆ‘åŒæ™‚ä¹Ÿé™„åœ¨ä¸‹åœ–ã€‚</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>path <span style=color:#ff79c6>=</span> path.merge(path.enter().insert(<span style=color:#f1fa8c>&#34;path&#34;</span>, <span style=color:#f1fa8c>&#34;.tick&#34;</span>)
    .attr(<span style=color:#f1fa8c>&#34;class&#34;</span>, <span style=color:#f1fa8c>&#34;domain&#34;</span>)
    .attr(<span style=color:#f1fa8c>&#34;stroke&#34;</span>, <span style=color:#f1fa8c>&#34;#000&#34;</span>));

line <span style=color:#ff79c6>=</span> line.merge(tickEnter.append(<span style=color:#f1fa8c>&#34;line&#34;</span>)
    .attr(<span style=color:#f1fa8c>&#34;stroke&#34;</span>, <span style=color:#f1fa8c>&#34;#000&#34;</span>)
    .attr(x <span style=color:#ff79c6>+</span> <span style=color:#f1fa8c>&#34;2&#34;</span>, k <span style=color:#ff79c6>*</span> tickSizeInner));

text <span style=color:#ff79c6>=</span> text.merge(tickEnter.append(<span style=color:#f1fa8c>&#34;text&#34;</span>)
    .attr(<span style=color:#f1fa8c>&#34;fill&#34;</span>, <span style=color:#f1fa8c>&#34;#000&#34;</span>)
    .attr(x, k <span style=color:#ff79c6>*</span> spacing)
    .attr(<span style=color:#f1fa8c>&#34;dy&#34;</span>, orient <span style=color:#ff79c6>===</span> top <span style=color:#ff79c6>?</span> <span style=color:#f1fa8c>&#34;0em&#34;</span> <span style=color:#ff79c6>:</span> orient <span style=color:#ff79c6>===</span> bottom <span style=color:#ff79c6>?</span> <span style=color:#f1fa8c>&#34;0.71em&#34;</span> <span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;0.32em&#34;</span>));
</code></pre></td></tr></table></div></div><p>è€Œå¾Œä¾†ï¼Œä½œè€…è‡ªå·±é–‹äº†é€™å€‹
<a href=https://github.com/d3/d3-axis/issues/49 rel=noopener target=_blank>issue</a>
ä¸¦æ›´æ”¹æˆ<code>fill="currentcolor"</code>ï¼Œå¦‚ä¸‹åœ–ã€‚</p><p><img src=/20210516/d3-brush-demo3.png alt="change-to-fill=currentcolor"></p><h3 id=currentcolor-æ˜¯ä»€éº¼>currentcolor æ˜¯ä»€éº¼ï¼Ÿ<a hidden class=anchor aria-hidden=true href=#currentcolor-æ˜¯ä»€éº¼>#</a></h3><p>fill, stroke é€™äº›è¨­å®šé¡è‰²çš„å±¬æ€§ï¼Œé™¤äº†å¯ä»¥è¨­ç‚ºä¸€å€‹é¡è‰²çš„ rgb å€¼ã€hex å€¼ç­‰ï¼Œä¹Ÿå¯ä»¥è¨­å®šç‚º currentcolorï¼Œå¦‚<code>fill="currentcolor"</code>ã€‚</p><p>è€Œç©¶ç«Ÿä»–æœƒè¨­å®šæˆä»€éº¼é¡è‰²å‘¢ï¼Œç­”æ¡ˆæ˜¯ color é€™å€‹å±¬æ€§çš„é¡è‰²ï¼Œè‹¥æ²’æœ‰è¨­å®š color å‰‡æœƒç¹¼æ‰¿ parent çš„ colorã€‚</p><p>currentcolor è®“æˆ‘å€‘åœ¨è¨­å®šé¡è‰²æ™‚ï¼Œå¯ä»¥é€éä¸Šå±¤çš„ color ä¾†çµ±ä¸€ç’°å¢ƒçš„é¡è‰²ï¼Œä¸å¿…å–®ç¨ç®¡ç†æ¯å€‹å­å…ƒç´ çš„é¡è‰²ã€‚</p><p>ä»¥ä¸Šè¿°æåˆ° d3-axis çš„ issue ä¾†èˆ‰ä¾‹ï¼Œä½œè€…çš„è€ƒé‡æ˜¯å¸Œæœ› axis çš„é¡è‰²å¯ä»¥å½ˆæ€§çš„æ›´æ”¹ã€‚è‹¥å¯«æ­»æˆé»‘è‰²ï¼Œç•¶èƒŒæ™¯è‰²æ˜¯æ·±è‰²çš„æƒ…æ³ä¸‹ï¼Œå°±éœ€è¦é é–‹ç™¼è€…è‡ªå·±å»é‡æ–°è¨­å®šé¡è‰²ã€‚</p><p>æˆ‘æ ¹æ“šé€™å€‹æƒ…å¢ƒå¯«äº†ä¸€å€‹
<a href=https://observablehq.com/@uier/d3-axis-in-dark-mode-between-v4-v5 rel=noopener target=_blank>ç¯„ä¾‹</a>
ï¼Œè®“å¤§å®¶å¯ä»¥å°æ¯”é€™å€‹æ”¹è®Šçš„å¨åŠ›ã€‚</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://uier.github.io/blog/tags/d3.js/>d3.js</a></li><li><a href=https://uier.github.io/blog/tags/svg/>svg</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://uier.github.io/blog/>TzuWei's Blog ğŸ </a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script defer src=/blog/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.replaceState(null,null,`#${a}`)})});var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>